<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project | LEE KYUNTAE</title>

  <!-- 사용자가 제공한 CSS 그대로 사용 -->
  <link rel="stylesheet" href="./style.css" />
</head>

<body class="page">
  <div class="page-shell">
    <header>
      <nav class="top-nav" aria-label="Primary">
        <div class="nav-left">
          <a href="resume.html">RESUME</a>
          <a href="info.html">INFO</a>
        </div>

        <h1 class="site-title">
          <a class="brand" href="index.html" aria-label="Go to home">
            <img src="assets/site-title-scaled.png" alt="LEE KYUNTAE" />
          </a>
        </h1>

        <div class="nav-right">
          <a href="project.html" aria-current="page">PROJECT</a>
        </div>
      </nav>

      <p class="subtitle">LEE KYUNTAE DESIGN STUDIO</p>
    </header>

    <main class="page-content">
      <span class="section-title">Project</span>
      <p class="project-hint">
        프로젝트를 클릭하면 아래로 펼쳐집니다. 이미지가 여러 장이면 좌/우 버튼으로 넘길 수 있습니다.
      </p>

      <div class="project-list project-list--accordion" id="projectList" aria-label="Project list">
        <!-- JS 렌더 -->
      </div>
    </main>

    <footer class="page-footer">
      © 2025 LEE KYUNTAE. All Rights Reserved.<br />
      주소 : 의정부시 범골로29번길 34 \ 연락처 : 010-8758-2710 \ Contact : rbsxo0710@gmail.com
    </footer>
  </div>

  <script>
    /* =========================================================
       EDIT HERE ONLY
       - 각 프로젝트의 images 배열에 원하는 만큼 이미지 경로를 넣으시면 됩니다.
       - 지금은 이미지가 없어도 보이도록 placeholder를 넣어둔 상태입니다.
       ========================================================= */

    function svgPlaceholder(label) {
      const svg =
        "<svg xmlns='http://www.w3.org/2000/svg' width='1400' height='900'>" +
          "<defs>" +
            "<linearGradient id='g' x1='0' x2='1' y1='0' y2='1'>" +
              "<stop offset='0' stop-color='#f4f4f5'/>" +
              "<stop offset='1' stop-color='#d6d6d6'/>" +
            "</linearGradient>" +
          "</defs>" +
          "<rect width='1400' height='900' fill='url(#g)'/>" +
          "<text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' " +
                "font-family='Montserrat, Arial' font-size='44' fill='#666'>" +
            label +
          "</text>" +
        "</svg>";
      return "data:image/svg+xml;utf8," + encodeURIComponent(svg);
    }

    const PROJECTS = [
      {
        id: "p01",
        no: "01",
        title: "Side Table No.01",
        year: "2024",
        category: "Table",
        images: [
          "./assets/1/1.jpeg",
          "./assets/1/2.jpeg",
          "./assets/1/3.jpeg",
          "./assets/1/4.jpeg",
          "./assets/1/5.jpeg",
          "./assets/1/6.jpeg",
        ],
        summary:
          "해당 가구는 우리 일상 속 많은 비율을 차지하는 서양식 가구의 한국적 재해석을 목표로 한다. 작가는 해당 가구를 통해, 건축과 가구에 존재하는 ‘수직구조물’에 대한 고찰을 심도있게 풀어낸다. 가구에서 수직구조물은 동서양을 막론하고 필수적으로 존재한다. 한국 고유의 수직구조물인 ‘장승’을 서양식 가구의 근간이 되는 미드센추리 모던 스타일에 접목시킴으로써 두 문화의 어우러짐을 꾀한다.",
        meta: {
          tools: "Ginkgo, walnut, steel, cupronickel",
          duration: "2024",
          size: "40 x 28 x 53(h) cm"
        },
        highlights: [
          "상판 하중과 흔들림을 줄이기 위한 다리 각도/두께 반복 테스트",
          "표면 마감에서 반사율·촉감 균형을 위한 샌딩 단계 세분화",
          "분해/이동을 고려한 결합부 구조 검토"
        ],
      },

      {
        id: "p02",
        no: "02",
        title: "Villustool",
        year: "2024",
        category: "Stool",
        images: [
          "./assets/2/1.jpeg",
          "./assets/2/2.jpeg",
          "./assets/2/3.jpeg",
          "./assets/2/4.jpeg",
          "./assets/2/5.jpeg",
          "./assets/2/6.jpeg",
        ],
        summary:
          "공간에 ‘툭’ 두기 좋은 스툴을 목표로, 이동성(무게/그립)과 시각적 리듬(다리 각도/상판 비율)을 함께 설계했습니다.",
        meta: {
          tools: "Stone, fabric",
          duration: "2024",
          size: "55 x 34 x 42 (cm)"
        },
        highlights: [
          "단순한 실루엣 안에서 비례로 캐릭터 부여",
          "다리 각도/두께를 조정해 안정감 확보",
          "표면 마감에 따른 촉감/반사율 튜닝"
        ],
      },

      {
        id: "p03",
        no: "03",
        title: "Bronchair",
        year: "2024",
        category: "Chair",
        images: [
          "./assets/3/1.jpeg",
          "./assets/3/2.jpeg",
          "./assets/3/3.jpeg",
          "./assets/3/4.jpeg",
          "./assets/3/5.jpeg",
          "./assets/3/6.jpeg",
        ],
        summary:
          "의자라는 기능적 오브젝트에 ‘무게감 있는 표정’을 부여하고자 했습니다. 금속의 질감과 곡면을 조합해 조형성과 착석감을 동시에 담았습니다.",
        meta: {
          tools: "Steel, PE, PET",
          duration: "2024.10 – 2024.12",
          size: "60 x 59 x 79.5 (cm)"
        },
      },

      {
        id: "p04",
        no: "04",
        title: "Heartable",
        year: "2024",
        category: "Chair",
        images: [
          "./assets/4/1.jpeg",
          "./assets/4/2.jpeg",
          "./assets/4/3.jpeg",
          "./assets/4/4.jpeg",
          "./assets/4/5.jpeg",
          "./assets/4/6.jpeg",
        ],
        summary:
          "의자라는 기능적 오브젝트에 ‘무게감 있는 표정’을 부여하고자 했습니다. 금속의 질감과 곡면을 조합해 조형성과 착석감을 동시에 담았습니다.",
        meta: {
          tools: "Acrylic, plaster",
          duration: "2024",
          size: "60 x 40 x 30 (cm)"
        }
      },

      {
        id: "p05",
        no: "05",
        title: "아더에러 스토어 디자인 제안 'EARTHPACE'",
        year: "2023",
        category: "Chair",
        images: [
          "./assets/5/1.png",
          "./assets/5/2.png",
          "./assets/5/3.png",
          "./assets/5/4.png",
          "./assets/5/5.png",
          "./assets/5/6.png",
        ],
        summary:
          "의자라는 기능적 오브젝트에 ‘무게감 있는 표정’을 부여하고자 했습니다. 금속의 질감과 곡면을 조합해 조형성과 착석감을 동시에 담았습니다.",
        meta: {
          tools: "Acrylic, plaster",
          duration: "2024",
          size: "60 x 40 x 30 (cm)"
        }
      }
    ];

    /* =========================================================
       RENDER
       ========================================================= */

    const listEl = document.getElementById("projectList");

    function escapeHtml(s) {
      return String(s)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function render() {
      listEl.innerHTML = PROJECTS.map((p) => {
        const links = (p.links || []).map(l =>
          `<a href="${escapeHtml(l.href)}" target="_blank" rel="noopener noreferrer">${escapeHtml(l.label)}</a>`
        ).join(" / ");

        return `
          <section class="project-entry" data-project-id="${escapeHtml(p.id)}">
            <button type="button" class="project-item" aria-expanded="false" aria-controls="detail-${escapeHtml(p.id)}">
              <span class="p-id">${escapeHtml(p.no)}</span>
              <span class="p-title">${escapeHtml(p.title)}</span>
              <span class="p-year">${escapeHtml(p.year)}</span>
              <span class="p-cat">${escapeHtml(p.category)}</span>
              <span class="p-toggle" aria-hidden="true"></span>
            </button>

            <div class="project-detail" id="detail-${escapeHtml(p.id)}" hidden>
              <div class="project-detail-inner">

                <div class="project-gallery" data-gallery style="position:relative;">
                  <img data-gallery-img src="" alt="" />

                  <button type="button" data-gallery-prev
                    aria-label="Previous image"
                    style="
                      position:absolute; left:12px; top:50%; transform:translateY(-50%);
                      width:40px; height:40px; border-radius:999px; border:1px solid rgba(0,0,0,0.15);
                      background:rgba(255,255,255,0.9); cursor:pointer; display:grid; place-items:center;
                      font-size:18px; line-height:1; opacity:0.9;
                    ">‹</button>

                  <button type="button" data-gallery-next
                    aria-label="Next image"
                    style="
                      position:absolute; right:12px; top:50%; transform:translateY(-50%);
                      width:40px; height:40px; border-radius:999px; border:1px solid rgba(0,0,0,0.15);
                      background:rgba(255,255,255,0.9); cursor:pointer; display:grid; place-items:center;
                      font-size:18px; line-height:1; opacity:0.9;
                    ">›</button>

                  <div data-gallery-dots
                    aria-label="Image pagination"
                    style="
                      position:absolute; left:0; right:0; bottom:10px;
                      display:flex; justify-content:center; gap:8px;
                      padding:0 10px;
                    "></div>
                </div>

                <div>
                  <p class="project-summary">${escapeHtml(p.summary || "")}</p>

                  <div class="project-detail-grid">

                    <div class="project-block">
                      <h3>Meta</h3>
                      <dl class="project-meta">
                        <div class="dl-row"><dt>Tools</dt><dd>${escapeHtml(p.meta?.tools || "")}</dd></div>
                        <div class="dl-row"><dt>Duration</dt><dd>${escapeHtml(p.meta?.duration || "")}</dd></div>
                        <div class="dl-row"><dt>Size</dt><dd>${escapeHtml(p.meta?.size || "")}</dd></div>
                      </dl>

                      ${links ? `<p class="project-note"><strong>Links</strong>: ${links}</p>` : ""}
                    </div>

                  </div>
                </div>

              </div>
            </div>
          </section>
        `;
      }).join("");

      bindAccordion();
    }

    /* =========================================================
       ACCORDION (inline expand below)
       ========================================================= */

    function setExpanded(entryEl, expanded) {
      const btn = entryEl.querySelector(".project-item");
      const detail = entryEl.querySelector(".project-detail");
      const inner = entryEl.querySelector(".project-detail-inner");

      btn.setAttribute("aria-expanded", expanded ? "true" : "false");

      if (expanded) {
        entryEl.classList.add("is-open");
        detail.hidden = false;
        requestAnimationFrame(() => {
          detail.style.maxHeight = inner.scrollHeight + "px";
        });
      } else {
        entryEl.classList.remove("is-open");
        detail.style.maxHeight = inner.scrollHeight + "px";
        requestAnimationFrame(() => {
          detail.style.maxHeight = "0px";
        });
        const onEnd = () => {
          detail.hidden = true;
          detail.removeEventListener("transitionend", onEnd);
        };
        detail.addEventListener("transitionend", onEnd);
      }
    }

    function closeOthers(exceptId) {
      document.querySelectorAll(".project-entry").forEach(entry => {
        const id = entry.getAttribute("data-project-id");
        if (id === exceptId) return;
        const btn = entry.querySelector(".project-item");
        if (btn.getAttribute("aria-expanded") === "true") {
          setExpanded(entry, false);
        }
      });
    }

    function openByHash() {
      const id = (location.hash || "").replace("#", "");
      if (!id) return;

      const entry = document.querySelector(`.project-entry[data-project-id="${CSS.escape(id)}"]`);
      if (!entry) return;

      closeOthers(id);
      setExpanded(entry, true);

      const btn = entry.querySelector(".project-item");
      btn.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    /* =========================================================
       GALLERY (prev/next + dots)
       ========================================================= */

    const galleryState = new Map(); // projectId -> { index }

    function initGallery(entryEl, project) {
      const img = entryEl.querySelector("[data-gallery-img]");
      const prev = entryEl.querySelector("[data-gallery-prev]");
      const next = entryEl.querySelector("[data-gallery-next]");
      const dots = entryEl.querySelector("[data-gallery-dots]");

      const projectId = project.id;
      const images = (project.images || []).slice();
      const count = images.length || 1;

      galleryState.set(projectId, { index: 0 });

      function renderGallery() {
        const st = galleryState.get(projectId);
        const idx = st.index;

        const src = images[idx] || svgPlaceholder(project.title + " — 01");
        img.src = src;
        img.alt = `${project.title} image ${idx + 1} of ${count}`;

        const multi = count > 1;
        prev.disabled = !multi;
        next.disabled = !multi;

        dots.innerHTML = "";
        if (multi) {
          for (let i = 0; i < count; i++) {
            const b = document.createElement("button");
            b.type = "button";
            b.setAttribute("aria-label", `Go to image ${i + 1}`);
            b.setAttribute("aria-current", i === idx ? "true" : "false");
            b.style.width = "7px";
            b.style.height = "7px";
            b.style.borderRadius = "999px";
            b.style.border = "1px solid rgba(255,255,255,0.6)";
            b.style.background = i === idx ? "rgba(0,0,0,0.55)" : "rgba(0,0,0,0.18)";
            b.style.cursor = "pointer";
            b.addEventListener("click", (e) => {
              e.stopPropagation();
              st.index = i;
              renderGallery();
              refreshEntryHeight(entryEl);
            });
            dots.appendChild(b);
          }
        }

        img.onload = () => refreshEntryHeight(entryEl);
      }

      function goPrev() {
        const st = galleryState.get(projectId);
        if (count <= 1) return;
        st.index = (st.index - 1 + count) % count;
        renderGallery();
      }

      function goNext() {
        const st = galleryState.get(projectId);
        if (count <= 1) return;
        st.index = (st.index + 1) % count;
        renderGallery();
      }

      prev.addEventListener("click", (e) => { e.stopPropagation(); goPrev(); });
      next.addEventListener("click", (e) => { e.stopPropagation(); goNext(); });

      renderGallery();
    }

    function refreshEntryHeight(entryEl) {
      const btn = entryEl.querySelector(".project-item");
      if (btn.getAttribute("aria-expanded") !== "true") return;
      const detail = entryEl.querySelector(".project-detail");
      const inner = entryEl.querySelector(".project-detail-inner");
      detail.style.maxHeight = inner.scrollHeight + "px";
    }

    function bindAccordion() {
      // 갤러리 초기화
      document.querySelectorAll(".project-entry").forEach(entry => {
        const projectId = entry.getAttribute("data-project-id");
        const project = PROJECTS.find(p => p.id === projectId);
        if (project) initGallery(entry, project);
      });

      // 아코디언 토글
      listEl.addEventListener("click", (e) => {
        const btn = e.target.closest(".project-item");
        if (!btn) return;

        const entry = btn.closest(".project-entry");
        const id = entry.getAttribute("data-project-id");
        const isOpen = btn.getAttribute("aria-expanded") === "true";

        if (isOpen) {
          setExpanded(entry, false);
          history.replaceState(null, "", location.pathname);
          return;
        }

        closeOthers(id);
        setExpanded(entry, true);
        history.replaceState(null, "", `#${id}`);
      });

      window.addEventListener("resize", () => {
        document.querySelectorAll(".project-entry").forEach(refreshEntryHeight);
      });
    }

    // init
    render();
    openByHash();
    window.addEventListener("hashchange", openByHash);
  </script>
</body>
</html>
